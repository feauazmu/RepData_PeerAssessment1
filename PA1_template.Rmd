---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

```{r setoptions, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load the libraries.
```{r loadlibraries, results="hide"}
library(dplyr)
library(ggplot2)
```


## Loading and preprocessing the data

Load the data.

```{r}
activityDF <- read.csv(unz("activity.zip", "activity.csv"), na.strings = "NA")
```

Process the data.

```{r}
activityDF$date <- as.Date(activityDF$date, format = "%Y-%m-%d")
```

## What is mean total number of steps taken per day?

Calculate the total number of steps taken per day.

```{r}

totalStepsPerDay <- activityDF %>% group_by(date) %>% 
    summarise(steps = sum(steps, na.rm = TRUE))
head(totalStepsPerDay)
```

Histogram of total number of steps per day.

```{r}
with(totalStepsPerDay, qplot(steps, geom = "histogram",
                             binwidth = 1000,
                             xlab = "Steps",
                             ylab = "Frequency", 
                             main = "Total number of steps taken per day"))
```

Calculate the mean and median of the total number of steps taken per day.

```{r}
summaryStepsPerDay <- summary(totalStepsPerDay$steps)
```

The mean of the total number of steps taken per day is: 
`r format(round(summaryStepsPerDay["Mean"][[1]], 2))` and the median is:
`r format(round(summaryStepsPerDay["Median"][[1]], 2))`

## What is the average daily activity pattern?

Calculate the number of steps taken averaged across all days per 5-minute 
intervals.

```{r}
averageStepsPerInterval <- activityDF %>% group_by(interval) %>% 
    summarise(steps = mean(steps, na.rm = TRUE))
head(averageStepsPerInterval)
```

Time series plot of the 5-minute interval and the average number of steps taken, 
averaged across all days

```{r}
with(averageStepsPerInterval, qplot(x = interval, y = steps, geom = "line",
                                    xlab = "5-minute interval",
                                    ylab = "Average number of steps",
                                    main = "Average number of steps taken per 5-minute interval averaged across all days"))
```

Which 5-minute interval, on average across all the days in the dataset, contains 
the maximum number of steps?

```{r}
maxInterval <- averageStepsPerInterval$interval[which.max(averageStepsPerInterval$steps)]
```

The 5-minute interval, on average across all the days that contains the maximum 
maximum number of steps is: `r maxInterval`.

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
